---
tomcat_soft_url: http://archive.apache.org/dist/tomcat/tomcat-'

tomcat_exclusions:
  - 'bin/commons-daemon-native.tar.gz'
  - 'bin/shutdown.sh'
  - 'bin/startup.sh'
  - 'bin/tomcat-native.tar.gz'
  - 'conf/logging.properties'
  - 'conf/server.xml'
  - 'conf/web.xml'
  - 'lib/tomcat-websocket.jar'
  - 'lib/websocket-api.jar'
  - 'webapps/docs'
  - 'webapps/examples'
  - 'webapps/host-manager'
  - 'webapps/manager'
  - 'webapps/ROOT'

support_jars:
  - 'disruptor.jar'
  - 'gelf-accesslog-valve.jar'
  - 'jmx_prometheus_javaagent.jar'
  - 'libwrapper.so'
  - 'log4j-api.jar'
  - 'log4j-core.jar'
  - 'log4j-jmx-gui.jar'
  - 'log4j-jul.jar'
  - 'logstash-gelf.jar'
  - 'noetagfilter.jar'
  - 'wrapper.jar'

support_binary:
  - 'wrapper'
  - 'tomcat.init'

tomcat_conf:
  - 'log4j2.xml'
  - 'prometheus.yml'
  - 'server.xml'
  - 'web.xml'
  - 'wrapper.conf'

server_certificate:
  - 'server.pem'

tomcat_environment:
  - 'export JAVA_HOME={{ java_home }}'
  - 'export PATH=$PATH:{{ java_home }}/bin'
  - 'export CATALINA_HOME={{ tomcat_arg.path }}'
  - 'export CLASSPATH={{ java_home }}/jre/lib:{{ java_home }}/lib:{{ java_home }}/lib/tools.jar'
  - 'export CLASSPATH=$CLASSPATH:{{ tomcat_arg.path }}/lib:.'
  - 'export LC_CTYPE="{{ tomcat_arg.lc_ctype }}"'

restrict_path:
  - '{{ tomcat_arg.path }}/bin'
  - '{{ tomcat_arg.path }}/logs'
  - '{{ tomcat_arg.path }}/temp'
  - '{{ tomcat_arg.path }}/webapps'

service_privilege:
  - '%{{ tomcat_arg.user }} {{ inventory_hostname }}=/usr/bin/systemctl restart tomcat.service'
  - '%{{ tomcat_arg.user }} {{ inventory_hostname }}=/usr/bin/systemctl stop tomcat.service'
  - '%{{ tomcat_arg.user }} {{ inventory_hostname }}=/usr/bin/systemctl start tomcat.service'
  - '%{{ tomcat_arg.user }} {{ inventory_hostname }}=/usr/bin/systemctl status tomcat.service'